<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>OpenRouter Chat</title>
  <link rel="stylesheet" href="/static/styles.css" />
</head>

<body>
  <header>
    <h1>Ziggazigah</h1>
  </header>

  <main>
    <section class="controls">
      <button id="model-explorer-button" type="button" class="ghost-button">Model explorer</button>
      <label class="visually-hidden" for="model-select">Model</label>
      <select id="model-select" autocomplete="off">
        <option value="openrouter/auto">Loading models…</option>
      </select>
      <button id="clear-chat" type="button">Clear chat</button>
      <button id="open-settings" type="button" class="ghost-button">Model settings</button>
    </section>

    <section id="chat-log" aria-live="polite"></section>

    <form id="chat-form">
      <label class="visually-hidden" for="message-input">Message</label>
      <div class="chat-input">
        <textarea id="message-input" placeholder="Send a message to the selected model…" rows="3" required></textarea>
        <button id="stop-button" type="button" class="ghost-button" hidden>Stop</button>
      </div>
    </form>
  </main>


  <div id="model-settings-modal" class="modal" aria-hidden="true">
    <div class="modal__backdrop" id="model-settings-backdrop" data-close-settings></div>
    <div class="modal__dialog" role="dialog" aria-modal="true" aria-labelledby="model-settings-title">
      <form id="model-settings-form" class="settings-card model-settings-form">
        <header class="section-header modal__header">
          <div>
            <h2 id="model-settings-title">Active Model Settings</h2>
            <p class="section-subtitle">Control the default model, routing strategy, and hyperparameters.</p>
          </div>
          <div class="modal__header-actions">
            <p id="settings-updated-at" class="settings-meta" hidden></p>
            <button type="button" id="close-settings" class="icon-button" aria-label="Close model settings"
              data-close-settings>
              <span aria-hidden="true">×</span>
            </button>
          </div>
        </header>

        <div class="modal__body">
          <div class="form-group">
            <span class="field-label">Active model</span>
            <p id="active-model-display" class="field-display"></p>
            <p class="field-hint">Settings apply to the model currently selected in chat.</p>
          </div>

          <fieldset class="form-fieldset">
            <legend>Provider Routing</legend>
            <div class="form-grid two-column">
              <label class="field-group">
                <span class="field-label" for="provider-sort">Sort strategy</span>
                <select id="provider-sort">
                  <option value="">Auto (balanced)</option>
                  <option value="price">Price</option>
                  <option value="throughput">Throughput</option>
                  <option value="latency">Latency</option>
                </select>
              </label>
              <label class="field-group">
                <span class="field-label" for="provider-data-collection">Data collection</span>
                <select id="provider-data-collection">
                  <option value="">Allow (default)</option>
                  <option value="deny">Deny</option>
                </select>
                <p class="field-hint">Require zero data retention providers when set to deny.</p>
              </label>
              <label class="field-group">
                <span class="field-label" for="provider-allow-fallbacks">Allow fallbacks</span>
                <select id="provider-allow-fallbacks">
                  <option value="">Use provider default</option>
                  <option value="true">Allow fallback providers</option>
                  <option value="false">Disallow fallbacks</option>
                </select>
              </label>
              <label class="field-group">
                <span class="field-label" for="provider-require-parameters">Require parameters</span>
                <select id="provider-require-parameters">
                  <option value="">Use provider default</option>
                  <option value="true">Only providers supporting all parameters</option>
                  <option value="false">Best effort</option>
                </select>
              </label>
            </div>
          </fieldset>

          <fieldset class="form-fieldset">
            <legend>
              <span>Hyperparameters</span>
              <button type="button" id="reset-hyperparameters" class="legend-action">Use defaults</button>
            </legend>
            <div class="form-grid three-column">
              <div class="field-group slider-field" data-slider-field="param-temperature">
                <label class="field-label" for="param-temperature">Temperature</label>
                <div class="range-control">
                  <div class="range-row">
                    <input id="param-temperature" class="slider-input" type="range" min="0" max="2" step="0.01"
                      data-default-value="1" />
                    <output class="range-output" data-slider-value="param-temperature" aria-live="polite"></output>
                  </div>
                </div>
              </div>
              <div class="field-group slider-field" data-slider-field="param-top-p">
                <label class="field-label" for="param-top-p">Top P</label>
                <div class="range-control">
                  <div class="range-row">
                    <input id="param-top-p" class="slider-input" type="range" min="0" max="1" step="0.01"
                      data-default-value="1" />
                    <output class="range-output" data-slider-value="param-top-p" aria-live="polite"></output>
                  </div>
                </div>
              </div>
              <div class="field-group slider-field" data-slider-field="param-top-k">
                <label class="field-label" for="param-top-k">Top K</label>
                <div class="range-control">
                  <div class="range-row">
                    <input id="param-top-k" class="slider-input" type="range" min="0" max="400" step="1"
                      data-default-value="0" />
                    <output class="range-output" data-slider-value="param-top-k" aria-live="polite"></output>
                  </div>
                </div>
              </div>
              <div class="field-group slider-field" data-slider-field="param-min-p">
                <label class="field-label" for="param-min-p">Min P</label>
                <div class="range-control">
                  <div class="range-row">
                    <input id="param-min-p" class="slider-input" type="range" min="0" max="1" step="0.01"
                      data-default-value="0" />
                    <output class="range-output" data-slider-value="param-min-p" aria-live="polite"></output>
                  </div>
                </div>
              </div>
              <div class="field-group slider-field" data-slider-field="param-top-a">
                <label class="field-label" for="param-top-a">Top A</label>
                <div class="range-control">
                  <div class="range-row">
                    <input id="param-top-a" class="slider-input" type="range" min="0" max="1" step="0.01"
                      data-default-value="0" />
                    <output class="range-output" data-slider-value="param-top-a" aria-live="polite"></output>
                  </div>
                </div>
              </div>
              <div class="field-group slider-field" data-slider-field="param-max-tokens">
                <label class="field-label" for="param-max-tokens">Max tokens</label>
                <div class="range-control">
                  <div class="range-row">
                    <input id="param-max-tokens" class="slider-input" type="range" min="0" max="32000" step="1"
                      data-default-value="0" />
                    <output class="range-output" data-slider-value="param-max-tokens" aria-live="polite"></output>
                  </div>
                </div>
              </div>
              <div class="field-group slider-field" data-slider-field="param-frequency-penalty">
                <label class="field-label" for="param-frequency-penalty">Frequency penalty</label>
                <div class="range-control">
                  <div class="range-row">
                    <input id="param-frequency-penalty" class="slider-input" type="range" min="-2" max="2" step="0.01"
                      data-default-value="0" />
                    <output class="range-output" data-slider-value="param-frequency-penalty"
                      aria-live="polite"></output>
                  </div>
                </div>
              </div>
              <div class="field-group slider-field" data-slider-field="param-presence-penalty">
                <label class="field-label" for="param-presence-penalty">Presence penalty</label>
                <div class="range-control">
                  <div class="range-row">
                    <input id="param-presence-penalty" class="slider-input" type="range" min="-2" max="2" step="0.01"
                      data-default-value="0" />
                    <output class="range-output" data-slider-value="param-presence-penalty" aria-live="polite"></output>
                  </div>
                </div>
              </div>
              <div class="field-group slider-field" data-slider-field="param-repetition-penalty">
                <label class="field-label" for="param-repetition-penalty">Repetition penalty</label>
                <div class="range-control">
                  <div class="range-row">
                    <input id="param-repetition-penalty" class="slider-input" type="range" min="0" max="2" step="0.01"
                      data-default-value="1" />
                    <output class="range-output" data-slider-value="param-repetition-penalty"
                      aria-live="polite"></output>
                  </div>
                </div>
              </div>
              <div class="field-group slider-field" data-slider-field="param-seed">
                <label class="field-label" for="param-seed">Seed</label>
                <div class="range-control">
                  <div class="range-row">
                    <input id="param-seed" class="slider-input" type="range" min="0" max="1000000" step="1"
                      data-default-value="0" />
                    <output class="range-output" data-slider-value="param-seed" aria-live="polite"></output>
                  </div>
                </div>
              </div>
              <label class="field-group">
                <span class="field-label" for="param-parallel-tool-calls">Parallel tool calls</span>
                <select id="param-parallel-tool-calls">
                  <option value="">Use provider default</option>
                  <option value="true">Enable</option>
                  <option value="false">Disable</option>
                </select>
              </label>
              <label class="field-group">
                <span class="field-label" for="param-safe-prompt">Safe prompt</span>
                <select id="param-safe-prompt">
                  <option value="">Use provider default</option>
                  <option value="true">Enable</option>
                  <option value="false">Disable</option>
                </select>
              </label>
              <label class="field-group">
                <span class="field-label" for="param-raw-mode">Raw mode</span>
                <select id="param-raw-mode">
                  <option value="">Use provider default</option>
                  <option value="true">Enable</option>
                  <option value="false">Disable</option>
                </select>
              </label>
            </div>
            <label class="field-group full-span">
              <span class="field-label" for="param-stop">Stop sequences</span>
              <textarea id="param-stop" rows="3" placeholder="One sequence per line or comma-separated"></textarea>
            </label>
          </fieldset>
        </div>

        <footer class="form-actions modal__footer">
          <button type="submit" id="settings-submit">Save settings</button>
          <span id="settings-status" class="settings-status" role="status" aria-live="polite"></span>
        </footer>
      </form>
    </div>
  </div>


  <template id="message-template">
    <article class="message">
      <div class="meta">
        <span class="meta__label"></span>
        <button type="button" class="metadata-button" hidden>Usage</button>
      </div>
      <div class="content"></div>
    </article>
  </template>

  <div id="message-metadata-modal" class="modal" aria-hidden="true">
    <div class="modal__backdrop" id="message-metadata-backdrop" data-close-metadata></div>
    <div class="modal__dialog" role="dialog" aria-modal="true" aria-labelledby="message-metadata-title">
      <div class="settings-card metadata-card">
        <header class="section-header modal__header">
          <div>
            <h2 id="message-metadata-title">Usage Details</h2>
            <p class="section-subtitle">Token counts, cost, and caching breakdown for the last reply.</p>
          </div>
          <div class="modal__header-actions">
            <button type="button" id="close-message-metadata" class="icon-button" aria-label="Close usage details"
              data-close-metadata>
              <span aria-hidden="true">×</span>
            </button>
          </div>
        </header>
        <div class="modal__body">
          <div id="message-metadata-content" class="metadata-list"></div>
        </div>
      </div>
    </div>
  </div>

  <script src="/static/main.js" type="module"></script>
</body>

</html>
